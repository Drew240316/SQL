★ 자주 틀리는 것)
인라인 뷰의 테이블 alias를 썼다면 메인쿼리에서도 꼭 쓰기
인라인 뷰의 select절 컬럼들은 메인쿼리에서도 써야하면 꼭 쓰기



★ 패턴) 가장 큰 & 가장 제일 비싼

1) subquery + rank() over 

select category, price as max_price, product_name
from (
  select category, product_name, price,
         rank() over(partition by category order by price desc)as rk
  from food_product
  where category in ('과자','국','김치','식용유')
) t
where rk = 1
order by max_price desc


2) subquery + max 

SELECT 
    category,
    price AS max_price,
    product_name
FROM food_product f
WHERE 
    category IN ('과자','국','김치','식용유')
    AND price = (
        SELECT MAX(price)
        FROM food_product
        WHERE category = f.category   -- ← 여기서 바깥 f.category랑 연결 (상관 서브쿼리)
    )
ORDER BY max_price DESC;

-------- < 오답 > --------


select category, price as max_price, product_name
from (
select category, product_name, price, rank() over(partition by category order by price) rk
from food_product
where category in ('과자','국','김치','식용유')
)t
where rk = 1
order by max_price desc


이유 ? 윈도우 함수에서 order by에 desc /asc 쓰자. 




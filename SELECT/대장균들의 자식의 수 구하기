-- 1) left join + group by 

-- 최초의 대장균 개체의 parent는 null이다. : 할머니 - 부모님 - 자식이 모두 있다는 뜻.
-- 대장균 개체의 id와 자식의 수를 구해라 : 할머니 - 부모님 - 자식은(모든 개체는) 자식을 몇 명씩 낳았나요?
-- 테이블이 1개이면 할머니-부모님-자식까지 포함된 테이블을 left(기준 테이블)테이블로 만든다.
-- left테이블에 포함안되면 null임 그럼 count했을 경우 0

select a.id, count(b.id) as child_count
from ecoli_data a left join ecoli_data b
on a.id = b.PARENT_ID	
group by a.id
order by a.id
;



-- 2) 서브쿼리 기반

SELECT 
    ID,
    (SELECT COUNT(*) 
     FROM ECOLI_DATA 
     WHERE PARENT_ID = E.ID) AS CHILD_COUNT
FROM ECOLI_DATA E
ORDER BY ID;




-- 3) case when 

SELECT
    E.ID,
    IFNULL((
        SELECT COUNT(*)
        FROM ECOLI_DATA
        WHERE PARENT_ID = E.ID
    ), 0) AS CHILD_COUNT
FROM ECOLI_DATA E
ORDER BY E.ID;



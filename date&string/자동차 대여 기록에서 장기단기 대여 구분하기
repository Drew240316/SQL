★ 오답 )

select history_id, car_id, 
    date_format(start_date,'%Y-%m-%d') as start_date, 
    date_format(end_date,'%Y-%m-%d') as end_date,
    case
        when datediff(end_date,start_date) <= 29 then '단기 대여'
        when datediff(end_date,start_date) >= 30 then '장기 대여'
        end  as rent_type
from car_rental_company_rental_history
where year(start_date) = '2022' and month(start_date) = '09'
order by history_id desc
;

이유 ) datediff는 날짜의 흐름에 맞게 요일을 뺀다. end date가 30이고 start date가 1이면 29다. 
      그런데 사람이 생각했을 때는 30일로 계산한다. 그래서 + 1 필요.

★ 정답1 ) when 2번 쓰기 

select history_id, car_id, 
    date_format(start_date,'%Y-%m-%d') as start_date, 
    date_format(end_date,'%Y-%m-%d') as end_date,
    case
        when datediff(end_date,start_date) + 1 < 30 then '단기 대여'
        when datediff(end_date,start_date) > 30 then '장기 대여'
        end  as rent_type
from car_rental_company_rental_history
where year(start_date) = '2022' and month(start_date) = '09'
order by history_id desc
;

★ 정답2 ) when 1번 쓰기

select history_id, car_id, 
    date_format(start_date,'%Y-%m-%d') as start_date, 
    date_format(end_date,'%Y-%m-%d') as end_date,
    case
        when datediff(end_date,start_date) + 1 < 30 then '단기 대여'
        else '장기 대여'
        end  as rent_type
from car_rental_company_rental_history
where year(start_date) = '2022' and month(start_date) = '09'
order by history_id desc
;





★ 정답)

select history_id, car_id, 
    date_format(start_date,'%Y-%m-%d') as start_date, 
    date_format(end_date,'%Y-%m-%d') as end_date,
    case
        when datediff(end_date,start_date) + 1 < 30 then '단기 대여'
        else '장기 대여'
        end  as rent_type
from car_rental_company_rental_history
where year(start_date) = '2022' and month(start_date) = '09'
order by history_id desc
;

select b.flavor
from FIRST_HALF b
join (
    select flavor, sum(total_order) as total_order
    from july 
    group by flavor
) a
on b.flavor = a.flavor
order by (b.total_order + a.total_order) desc
limit 3
;


- first_half의 기본키는 falvor (1개씩) ,  shipment_id는 july의 외래키
- july의 기본키는 shipment_id (1개식) , flavor은 first_half의 외래키
- july는 같은 flavor이더라도 다른 shipment_id를 가짐 (=7월은 같은 맛이더라도 다른 공장에서 출하됨)
- july는 flavor로 total_order를 구해야 (오렌지 오렌지 스트로베리 포도처럼 각각의 맛들을 그룹화해서 합할 수 있음)
- july의 total_order를 sum하면, 이제 first_half와 동등한 조건으로 sum할 수 있음
- order by절은 expression할 수 있는 연산식,함수, alias가 가능하기에 두 테이블의 total_order를 더할 수 있음.
